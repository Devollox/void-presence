const h=document.getElementById("logs-view-list"),K=document.getElementById("logs-counter"),X=120,J=document.getElementById("nav-main"),w=document.getElementById("nav-logs"),H=document.getElementById("nav-config"),Z=document.querySelectorAll(".view");function M(e){Z.forEach(l=>{const o=l.getAttribute("data-view");l.setAttribute("data-active",o===e?"true":"false")}),J&&J.setAttribute("data-active",e==="main"?"true":"false"),w&&w.setAttribute("data-active",e==="logs"?"true":"false"),H&&H.setAttribute("data-active",e==="config"?"true":"false")}J&&J.addEventListener("click",()=>M("main"));w&&w.addEventListener("click",()=>M("logs"));H&&H.addEventListener("click",()=>M("config"));function U(e){if(!h)return;const l=new Date,o=String(l.getHours()).padStart(2,"0")+":"+String(l.getMinutes()).padStart(2,"0")+":"+String(l.getSeconds()).padStart(2,"0"),i=typeof e=="string"?{}:e,t=(i.level||i.type||"info").toLowerCase(),a=i.message||i.text||i.error||(typeof e=="string"?e:JSON.stringify(e)),s=/error/i.test(a)||/fails because/i.test(a),p=t==="error"||s,n=t==="success",m=document.createElement("div");m.className="log-item",p?m.classList.add("log-error"):n&&m.classList.add("log-success");const u=document.createElement("div");u.className="log-level-dot",p?u.classList.add("dot-error"):n&&u.classList.add("dot-success");const c=document.createElement("div");c.className="log-item-meta",c.textContent=o+" · "+t.toUpperCase();const r=document.createElement("div");for(r.className="log-item-message",a.split(`
`).forEach(g=>{const f=document.createElement("div");f.textContent=g,r.appendChild(f)}),m.appendChild(u),m.appendChild(c),m.appendChild(r),h.insertBefore(m,h.firstChild);h.children.length>X;)h.removeChild(h.lastChild);if(K){const g=h.children.length;K.textContent=g+" entries"}if(w){const g=h.firstChild,f=g&&g.classList.contains("log-error"),d=g&&g.classList.contains("log-success");w.classList.remove("sidebar-nav-item-error","sidebar-nav-item-success"),f?w.classList.add("sidebar-nav-item-error"):d&&w.classList.add("sidebar-nav-item-success")}}var Y;(Y=window.electronAPI)!=null&&Y.onLogMessage&&window.electronAPI.onLogMessage(e=>{U(e)});function ee(e){switch(e){case"DISABLED":return{chip:"IDLE",sub:"Waiting to start"};case"SEARCHING DISCORD":return{chip:"SEARCHING DISCORD PROCESS",sub:"Looking for Discord process"};case"CONNECTING RPC":return{chip:"CONNECTING",sub:"Attaching Rich Presence"};case"ACTIVE":return{chip:"ACTIVE",sub:"Presence is broadcasting"};case"RESTARTING":return{chip:"RESTARTING",sub:"Restarting Rich Presence"};case"DISCONNECTED":return{chip:"DISCONNECTED",sub:"Lost connection to Discord"};case"NO_CLIENT_ID":return{chip:"NO CLIENT",sub:"Set ID, cycles, update"};default:return{chip:"UNKNOWN",sub:e||""}}}function W(e){const l=document.getElementById("activity-title"),o=document.getElementById("activity-sub"),i=document.getElementById("info-buttons"),t=document.getElementById("info-object"),a=document.getElementById("info-details"),s=document.getElementById("info-status"),p=document.getElementById("meta-object"),n=document.getElementById("meta-buttons");if(!l||!o||!i||!t||!a||!s||!p||!n)return;if(!e){l.textContent="Idle",o.textContent="Waiting for Discord",i.textContent="–",t.textContent="–",a.textContent="–",s.textContent="No active rich presence",p.textContent="OBJECT: —",n.textContent="BUTTONS: —";return}l.textContent=e.details||"Rich Presence",o.textContent=e.state||"";const m=e.buttons&&e.buttons.length?e.buttons.map(u=>u.label).join(" -  "):"None";i.textContent=m,t.textContent=e.details||"–",a.textContent=e.state||"–",s.textContent="Active",p.textContent=`OBJECT: ${e.details||"—"}`,n.textContent=`BUTTONS: ${m}`}function T(e){const l=document.querySelector(".status-chip span"),o=document.querySelector(".status-dot"),i=document.getElementById("activity-sub"),t=ee(e);l&&(l.textContent=t.chip),i&&(i.textContent=t.sub),o&&(e==="ACTIVE"?o.style.background="radial-gradient(circle, #4ade80 0, #22c55e 50%, #000000 100%)":e==="DISCONNECTED"?o.style.background="radial-gradient(circle, #fb7185 0, #f97373 50%, #000000 100%)":e==="RESTARTING"||e==="CONNECTING RPC"?o.style.background="radial-gradient(circle, #facc15 0, #eab308 50%, #000000 100%)":e==="NO_CLIENT_ID"?o.style.background="radial-gradient(circle, #f97316 0, #ea580c 50%, #000000 100%)":o.style.background="radial-gradient(circle, #ffffff 0, #ffffff 50%, #000000 100%)")}async function te(){var o;const e=document.getElementById("update-interval-input");if(!e)return;const l=parseInt(localStorage.getItem("updateIntervalSec")||"30",10);!Number.isNaN(l)&&l>0&&(e.value=String(l),(o=window.electronAPI)!=null&&o.setActivityInterval&&await window.electronAPI.setActivityInterval(l))}function ne(){const e=document.getElementById("restart-discord");e&&e.addEventListener("click",l=>{var o;l.preventDefault(),(o=window.electronAPI)!=null&&o.restartDiscordRich&&(T("RESTARTING"),window.electronAPI.restartDiscordRich())})}function ae(e,l,o,i){const t=document.createElement("div");t.className="pair-row",t.dataset.index=String(l),t.draggable=!0;const a=document.createElement("div");a.className="pair-inputs";const s=document.createElement("input");s.placeholder="Label #1",s.value=e.label1||"";const p=document.createElement("input");p.placeholder="URL #1",p.value=e.url1||"";const n=document.createElement("input");n.placeholder="Label #2",n.value=e.label2||"";const m=document.createElement("input");m.placeholder="URL #2",m.value=e.url2||"";const u=document.createElement("button");u.className="remove-btn",u.type="button",u.textContent="×";function c(){o({label1:s.value,url1:p.value,label2:n.value,url2:m.value})}return s.addEventListener("input",c),p.addEventListener("input",c),n.addEventListener("input",c),m.addEventListener("input",c),u.addEventListener("click",r=>{r.preventDefault(),i()}),t.appendChild(u),a.appendChild(s),a.appendChild(p),a.appendChild(n),a.appendChild(m),t.appendChild(a),t}function ce(e,l,o,i){const t=document.createElement("div");t.className="cycle-row",t.dataset.index=String(l),t.draggable=!0;const a=document.createElement("div");a.className="cycle-inputs";const s=document.createElement("input");s.placeholder="Details",s.value=e.details||"";const p=document.createElement("input");p.placeholder="State",p.value=e.state||"";const n=document.createElement("button");n.className="remove-btn",n.type="button",n.textContent="×";function m(){o({details:s.value,state:p.value})}return s.addEventListener("input",m),p.addEventListener("input",m),n.addEventListener("click",u=>{u.preventDefault(),i()}),t.appendChild(n),a.appendChild(s),a.appendChild(p),t.appendChild(a),t}function oe(e,l,o,i){const t=document.createElement("div");t.className="image-row",t.dataset.index=String(l),t.draggable=!0;const a=document.createElement("div");a.className="image-inputs";const s=document.createElement("input");s.placeholder="Large image key or URL",s.value=e.largeImage||"";const p=document.createElement("input");p.placeholder="Large hover text",p.value=e.largeText||"";const n=document.createElement("input");n.placeholder="Small image key or URL",n.value=e.smallImage||"";const m=document.createElement("input");m.placeholder="Small hover text",m.value=e.smallText||"";const u=document.createElement("button");u.className="remove-btn",u.type="button",u.textContent="×";function c(){o({largeImage:s.value,largeText:p.value,smallImage:n.value,smallText:m.value})}return s.addEventListener("input",c),p.addEventListener("input",c),n.addEventListener("input",c),m.addEventListener("input",c),u.addEventListener("click",r=>{r.preventDefault(),i()}),t.appendChild(u),a.appendChild(s),a.appendChild(p),a.appendChild(n),a.appendChild(m),t.appendChild(a),t}function V(){const e=localStorage.getItem("clientId")||"",l=JSON.parse(localStorage.getItem("buttonPairs")||"[]")||[],o=JSON.parse(localStorage.getItem("cycles")||"[]")||[],i=JSON.parse(localStorage.getItem("imageCycles")||"[]")||[];return{clientId:e,buttonPairs:l,cycles:o,imageCycles:i}}async function q(e){var m,u,c,r,g,f;const l=(e.clientId||"").trim(),o=Array.isArray(e.buttonPairs)?e.buttonPairs:[],i=Array.isArray(e.cycles)?e.cycles:[],t=Array.isArray(e.imageCycles)?e.imageCycles:[],a=o.map(d=>{const v=(d.label1||"").trim(),y=(d.url1||"").trim(),I=(d.label2||"").trim(),C=(d.url2||"").trim(),E=!!(v&&y),b=!!(I&&C);return{label1:E?v:"",url1:E?y:"",label2:b?I:"",url2:b?C:""}}).filter(d=>d.label1&&d.url1||d.label2&&d.url2).map(d=>{const v={label1:d.label1,url1:d.url1};return d.label2&&d.url2&&(v.label2=d.label2,v.url2=d.url2),v}),s=i.map(d=>({details:(d.details||"").trim(),state:(d.state||"").trim()})).filter(d=>d.details.length>0||d.state.length>0),p=t.map(d=>({largeImage:(d.largeImage||"").trim(),largeText:(d.largeText||"").trim(),smallImage:(d.smallImage||"").trim(),smallText:(d.smallText||"").trim()})).filter(d=>d.largeImage.length>0||d.largeText.length>0||d.smallImage.length>0||d.smallText.length>0),n=Number(e.updateIntervalSec);if(!l||!s.length||!Number.isFinite(n)||n<=0){T("NO_CLIENT_ID");return}localStorage.setItem("clientId",l),localStorage.setItem("buttonPairs",JSON.stringify(a)),localStorage.setItem("cycles",JSON.stringify(s)),localStorage.setItem("imageCycles",JSON.stringify(p)),localStorage.setItem("updateIntervalSec",String(n)),(m=window.electronAPI)!=null&&m.setClientId&&await window.electronAPI.setClientId(l),(u=window.electronAPI)!=null&&u.setImageCycles&&await window.electronAPI.setImageCycles(p),(c=window.electronAPI)!=null&&c.setButtons&&await window.electronAPI.setButtons(a),(r=window.electronAPI)!=null&&r.setCycles&&await window.electronAPI.setCycles(s),(g=window.electronAPI)!=null&&g.setActivityInterval&&await window.electronAPI.setActivityInterval(n),(f=window.electronAPI)!=null&&f.restartDiscordRich&&await window.electronAPI.restartDiscordRich()}function ie(e,l){const o=document.getElementById("client-id-input");o&&(o.value=e.clientId||"",localStorage.setItem("clientId",e.clientId||""),localStorage.setItem("buttonPairs",JSON.stringify(e.buttonPairs||[])),localStorage.setItem("cycles",JSON.stringify(e.cycles||[])),localStorage.setItem("imageCycles",JSON.stringify(e.imageCycles||[])),l.buttonPairs=Array.isArray(e.buttonPairs)?e.buttonPairs:[],l.cycles=Array.isArray(e.cycles)?e.cycles:[],l.imageCycles=Array.isArray(e.imageCycles)?e.imageCycles:[],l.renderButtonPairs(),l.renderCycles(),l.renderImageCycles())}function G(e,l,o){if(e.innerHTML="",!l||!l.length){const i=document.createElement("div");i.className="config-details-empty",i.textContent=o==="cycles"?"No cycles saved":o==="images"?"No image configuration":"No buttons configured",e.appendChild(i);return}l.forEach((i,t)=>{const a=document.createElement("div");a.className="config-details-item";const s=document.createElement("div");s.className="config-details-item-main";const p=document.createElement("div");if(p.className="config-details-item-meta",o==="cycles"){const n=document.createElement("div");n.className="config-details-item-label",n.textContent=i.details||"No details";const m=document.createElement("div");m.className="config-details-item-sub",m.textContent=i.state||"No state",s.appendChild(n),s.appendChild(m);const u=document.createElement("div");u.className="config-details-pill",u.textContent=`#${t+1}`,p.appendChild(u)}else if(o==="images"){const n=document.createElement("div");n.className="config-details-item-label",n.textContent=i.largeText||i.largeImage||"Large image";const m=document.createElement("div");m.className="config-details-pill";const u=document.createElement("a");u.href=i.largeImage||"#",u.textContent=i.largeImage||"no large url",u.target="_blank",m.appendChild(u),s.appendChild(n),s.appendChild(m);const c=document.createElement("div");c.className="config-details-item-sub",c.textContent=i.smallText||i.smallImage||"Small image";const r=document.createElement("div");r.className="config-details-pill";const g=document.createElement("a");g.href=i.smallImage||"#",g.textContent=i.smallImage||"no",g.textContent!=="no"&&(g.target="_blank",r.appendChild(g),p.appendChild(c),p.appendChild(r))}else if(o==="buttons"){const n=document.createElement("div");n.className="config-details-item-label",n.textContent=i.label1||"Button 1";const m=document.createElement("div");m.className="config-details-pill";const u=document.createElement("a");u.href=i.url1||"#",u.textContent=i.url1||"no url 1",u.textContent!=="no url 1"&&(u.target="_blank",m.appendChild(u),s.appendChild(n),s.appendChild(m));const c=document.createElement("div");c.className="config-details-item-label",c.textContent=i.label2||"Button 2";const r=document.createElement("div");r.className="config-details-pill";const g=document.createElement("a");g.href=i.url2||"#",g.textContent=i.url2||"no url 2",g.textContent!=="no url 2"&&(g.target="_blank",r.appendChild(g),s.appendChild(c),s.appendChild(r))}a.appendChild(s),a.appendChild(p),e.appendChild(a)})}function le(){const e=document.getElementById("client-id-input"),l=document.getElementById("client-id-save"),o=document.getElementById("buttons-list"),i=document.getElementById("add-button-pair"),t=document.getElementById("cycles-list"),a=document.getElementById("add-cycle"),s=document.getElementById("images-list"),p=document.getElementById("add-image");if(!e||!l||!o||!i||!t||!a||!s||!p)return;l.type="button",e.value=localStorage.getItem("clientId")||"";const n={buttonPairs:[],cycles:[],imageCycles:[],renderButtonPairs:()=>{},renderCycles:()=>{},renderImageCycles:()=>{}};try{const c=localStorage.getItem("buttonPairs");c&&(n.buttonPairs=JSON.parse(c))}catch{}try{const c=localStorage.getItem("cycles");c&&(n.cycles=JSON.parse(c))}catch{}try{const c=localStorage.getItem("imageCycles");c&&(n.imageCycles=JSON.parse(c))}catch{}Array.isArray(n.buttonPairs)||(n.buttonPairs=[]),(!Array.isArray(n.cycles)||!n.cycles.length)&&(n.cycles=[{details:"Idling in the void",state:"Just vibing"},{details:"Counting stars",state:"Lost in space"},{details:"Listening to silence",state:"Deep focus"}]),Array.isArray(n.imageCycles)||(n.imageCycles=[]);function m(c,r,g){let f=null;c.addEventListener("dragstart",d=>{var C;const v=d.target;if(!v)return;if(v instanceof HTMLInputElement||v instanceof HTMLTextAreaElement||(C=window.getSelection())!=null&&C.toString()){d.preventDefault();return}const I=v.closest("[data-index]");I&&(f=Number(I.dataset.index),I.classList.add("dragging"))}),c.addEventListener("dragend",d=>{const v=d.target,y=v==null?void 0:v.closest("[data-index]");y&&y.classList.remove("dragging"),Array.from(c.children).forEach(I=>{I.classList.remove("drop-target-top","drop-target-bottom")}),f=null}),c.addEventListener("dragover",d=>{d.preventDefault();const v=d.target,y=v==null?void 0:v.closest("[data-index]");if(!y||f===null)return;Array.from(c.children).forEach(E=>{E.classList.remove("drop-target-top","drop-target-bottom")});const I=y.getBoundingClientRect();d.clientY-I.top<I.height/2?y.classList.add("drop-target-top"):y.classList.add("drop-target-bottom")}),c.addEventListener("drop",d=>{d.preventDefault();const v=d.target,y=v==null?void 0:v.closest("[data-index]");if(!y||f===null)return;const I=Number(y.dataset.index),C=y.getBoundingClientRect(),E=d.clientY-C.top;let b=I;E>=C.height/2&&(b=I+1);const[x]=r.splice(f,1);b>r.length&&(b=r.length),r.splice(b,0,x),g()})}n.renderButtonPairs=function(){o&&(o.innerHTML="",n.buttonPairs.forEach((r,g)=>{const f=ae(r,g,d=>{n.buttonPairs[g]=d},()=>{n.buttonPairs.splice(g,1),n.renderButtonPairs()});o.appendChild(f)}))},n.renderCycles=function(){t&&(t.innerHTML="",n.cycles.forEach((r,g)=>{const f=ce(r,g,d=>{n.cycles[g]=d},()=>{n.cycles.splice(g,1),n.renderCycles()});t.appendChild(f)}))},n.renderImageCycles=function(){s&&(s.innerHTML="",n.imageCycles.forEach((r,g)=>{const f=oe(r,g,d=>{n.imageCycles[g]=d},()=>{n.imageCycles.splice(g,1),n.renderImageCycles()});s.appendChild(f)}))},n.renderButtonPairs(),n.renderCycles(),n.renderImageCycles(),o&&m(o,n.buttonPairs,n.renderButtonPairs),t&&m(t,n.cycles,n.renderCycles),s&&m(s,n.imageCycles,n.renderImageCycles),i.addEventListener("click",c=>{c.preventDefault(),n.buttonPairs.push({label1:"",url1:"",label2:"",url2:""}),n.renderButtonPairs()}),a.addEventListener("click",c=>{c.preventDefault(),n.cycles.push({details:"",state:""}),n.renderCycles()}),p.addEventListener("click",c=>{c.preventDefault(),n.imageCycles.push({largeImage:"",largeText:"",smallImage:"",smallText:""}),n.renderImageCycles()});async function u(){const c=document.getElementById("update-interval-input"),r=c?parseInt(c.value.trim(),10):NaN,g={clientId:e.value,buttonPairs:n.buttonPairs,cycles:n.cycles,imageCycles:n.imageCycles,updateIntervalSec:r};await q(g)}l.addEventListener("click",c=>{c.preventDefault(),u()}),window.__voidPresenceCtx=n}function se(){const e=document.getElementById("auto-launch-toggle");if(!e)return;const l=localStorage.getItem("autoLaunch")==="true";e.dataset.on=l?"true":"false",e.addEventListener("click",()=>{var t;const i=!(e.dataset.on==="true");e.dataset.on=i?"true":"false",localStorage.setItem("autoLaunch",String(i)),(t=window.electronAPI)!=null&&t.setAutoLaunch&&window.electronAPI.setAutoLaunch(i)})}function re(){const e=document.getElementById("auto-hide-toggle");if(!e)return;const l=localStorage.getItem("autoHide")==="true";e.dataset.on=l?"true":"false",e.addEventListener("click",()=>{var t;const i=!(e.dataset.on==="true");e.dataset.on=i?"true":"false",localStorage.setItem("autoHide",String(i)),(t=window.electronAPI)!=null&&t.setAutoHide&&window.electronAPI.setAutoHide(i)})}function de(){const e=document.getElementById("stop-discord");e&&e.addEventListener("click",l=>{var o;l.preventDefault(),(o=window.electronAPI)!=null&&o.stopDiscordRich&&(T("DISABLED"),W(null),window.electronAPI.stopDiscordRich())})}function ue(){var o,i;const e=document.getElementById("window-close"),l=document.getElementById("window-minimize");e&&((o=window.electronAPI)!=null&&o.windowClose)&&e.addEventListener("click",()=>{var t,a;(a=(t=window.electronAPI)==null?void 0:t.windowClose)==null||a.call(t)}),l&&((i=window.electronAPI)!=null&&i.windowMinimize)&&l.addEventListener("click",()=>{var t,a;(a=(t=window.electronAPI)==null?void 0:t.windowMinimize)==null||a.call(t)})}function me(){const e=document.getElementById("config-details-overlay"),l=document.getElementById("config-details-close");if(!e||!l)return;function o(){e.dataset.open="false"}l.addEventListener("click",i=>{i.preventDefault(),o()}),e.addEventListener("click",i=>{i.target===e&&o()})}function ge(e){const l=document.getElementById("config-details-overlay"),o=document.getElementById("config-details-name"),i=document.getElementById("config-details-cycles"),t=document.getElementById("config-details-images"),a=document.getElementById("config-details-buttons");if(!l||!o||!i||!t||!a)return;const s=e.state||{};o.textContent=e.name||"Unnamed profile",G(i,s.cycles||[],"cycles"),G(t,s.imageCycles||[],"images"),G(a,s.buttonPairs||[],"buttons"),l.dataset.open="true"}function Q(e){const l=new FileReader;l.onload=o=>{var i;try{const t=String(((i=o.target)==null?void 0:i.result)||""),a=JSON.parse(t),s={clientId:void 0,cycles:Array.isArray(a.cycles)?a.cycles:[],imageCycles:Array.isArray(a.imageCycles)?a.imageCycles:[],buttonPairs:Array.isArray(a.buttonPairs)?a.buttonPairs:[]},p=document.getElementById("config-name-input"),n=p&&p.value.trim()||e.name.replace(/\.[^.]+$/,"")||"Imported profile";window.addConfigFromState&&window.addConfigFromState(n,s)}catch(t){console.error("Failed to import config",t)}},l.readAsText(e)}function pe(){const e=document.getElementById("import-overlay"),l=document.getElementById("import-close-btn"),o=document.getElementById("import-file-input");if(!e||!l||!o)return;function i(){e.dataset.open="false",o.value=""}l.addEventListener("click",t=>{t.preventDefault(),i()}),e.addEventListener("click",t=>{t.target===e&&i()}),o.addEventListener("change",()=>{const t=o.files&&o.files[0];t&&(Q(t),i())})}function fe(){const e=document.getElementById("config-name-input"),l=document.getElementById("config-save-btn"),o=document.getElementById("config-list"),i=document.getElementById("config-add-btn"),t=document.getElementById("config-export-btn");if(!e||!l||!o||!i||!t)return;function a(){try{const u=localStorage.getItem("vpConfigs");return u?JSON.parse(u):[]}catch{return[]}}function s(u){localStorage.setItem("vpConfigs",JSON.stringify(u))}function p(u,c){const r=JSON.stringify(u,null,2),g=new Blob([r],{type:"application/json"}),f=URL.createObjectURL(g),d=document.createElement("a");d.href=f,d.download=c,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(f)}function n(){const u=a().slice().sort((c,r)=>{const g=c.createdAt?new Date(c.createdAt).getTime():0;return(r.createdAt?new Date(r.createdAt).getTime():0)-g});o.innerHTML="",u.forEach(c=>{const r=c.state||{},f=(Array.isArray(r.cycles)?r.cycles:[])[0],d=(f==null?void 0:f.details)||"New cycle",v=(f==null?void 0:f.state)||"In the void",y=Array.isArray(r.imageCycles)&&r.imageCycles[0]||null,I=y&&y.largeImage?y.largeImage:"about:blank",C=document.createElement("div");C.className="config-activity-card";const E=document.createElement("div");E.className="config-activity-body";const b=document.createElement("div");b.className="config-activity-image";const x=document.createElement("img");x.src=I,x.alt="app icon",b.appendChild(x);const L=document.createElement("div");L.className="config-activity-details";const _=document.createElement("div");_.className="config-activity-title",_.textContent=c.name||"Unnamed profile";const F=document.createElement("div");F.className="config-activity-line",F.textContent=d;const j=document.createElement("div");j.className="config-activity-line",j.textContent=v;const z=document.createElement("div");z.className="config-activity-footer",L.appendChild(_),L.appendChild(F),L.appendChild(j),L.appendChild(z),E.appendChild(b),E.appendChild(L);const A=document.createElement("div");A.className="config-activity-actions";const D=document.createElement("button");D.className="config-activity-btn",D.textContent="load";const O=document.createElement("button");O.className="config-activity-btn",O.textContent="details";const k=document.createElement("button");k.className="config-activity-btn",k.textContent="export";const R=document.createElement("button");R.className="config-activity-btn danger",R.textContent="✕",D.addEventListener("click",async S=>{S.preventDefault();const N=window.__voidPresenceCtx;if(!N)return;const B={clientId:r.clientId||localStorage.getItem("clientId")||"",updateIntervalSec:r.updateIntervalSec||localStorage.getItem("updateIntervalSec")||"",buttonPairs:Array.isArray(r.buttonPairs)?r.buttonPairs:[],cycles:Array.isArray(r.cycles)?r.cycles:[],imageCycles:Array.isArray(r.imageCycles)?r.imageCycles:[]};ie(B,N),await q(B),e.value="",M("main")}),O.addEventListener("click",S=>{S.preventDefault(),ge(c)}),k.addEventListener("click",S=>{S.preventDefault();const N={clientId:void 0,cycles:r.cycles&&r.cycles.slice()||[],imageCycles:r.imageCycles&&r.imageCycles.slice()||[],buttonPairs:r.buttonPairs&&r.buttonPairs.slice()||[]},B=c.name||`void-presence-${new Date().toISOString().slice(0,10)}`;p(N,`${B}.json`)}),R.addEventListener("click",S=>{S.preventDefault();const N=a().filter(B=>B.name!==c.name);s(N),n()}),A.appendChild(D),A.appendChild(O),A.appendChild(k),A.appendChild(R),C.appendChild(E),C.appendChild(A),o.appendChild(C)})}function m(u,c){const r=a().filter(g=>g.name!==u);r.push({name:u,state:c,createdAt:new Date().toISOString()}),s(r),n()}window.addConfigFromState=m,l.addEventListener("click",async u=>{u.preventDefault();const c=e.value.trim();if(!c)return;const r=V();m(c,r),await q(r),e.value=""}),i.addEventListener("click",u=>{u.preventDefault();const c=document.getElementById("import-overlay");c&&(c.dataset.open="true")}),t.addEventListener("click",u=>{u.preventDefault();const c=V(),r={clientId:void 0,cycles:c.cycles||[],imageCycles:c.imageCycles||[],buttonPairs:c.buttonPairs||[]},g=e.value.trim()||`void-presence-${new Date().toISOString().slice(0,10)}`;p(r,`${g}.json`)}),n()}let P=0,$;function ve(){const e=document.getElementById("global-drop-overlay"),l=document.querySelector(".app");if(!e||!l)return;P=0;function o(){e.dataset.active="true"}$=function(){e.dataset.active="false"};function i(t){return Array.from(t).some(a=>a.kind==="file")}document.addEventListener("dragenter",t=>{var s;const a=(s=t.dataTransfer)==null?void 0:s.items;!a||!a.length||i(a)&&(P+=1,o(),t.preventDefault())}),document.addEventListener("dragover",t=>{var s;const a=(s=t.dataTransfer)==null?void 0:s.items;!a||!a.length||i(a)&&(t.preventDefault(),t.dataTransfer&&(t.dataTransfer.dropEffect="copy"))}),document.addEventListener("dragleave",t=>{const a=t.relatedTarget;(!a||!l.contains(a))&&(P-=1,P<=0&&(P=0,$()))}),document.addEventListener("drop",t=>{var p;const a=(p=t.dataTransfer)==null?void 0:p.files;if(P=0,$(),!a||!a.length)return;t.preventDefault();const s=a[0];s&&Q(s)})}function ye(){const e=document.getElementById("cloud-upload-btn");if(!e)return;function l(){const t=document.getElementById("config-author-input");t&&localStorage.setItem("configAuthor",t.value)}function o(){const t=document.getElementById("config-name-input"),a=document.getElementById("config-author-input"),s=localStorage.getItem("configAuthor")||"";t&&(t.value=""),a&&(a.value=s)}const i=document.getElementById("config-author-input");i&&i.addEventListener("input",l),e.addEventListener("click",async t=>{var n;t.preventDefault();const a=document.getElementById("config-name-input"),s=document.getElementById("config-author-input"),p=window.__voidPresenceCtx;if(!(a!=null&&a.value.trim())||!(s!=null&&s.value.trim())||!p){U({message:"Enter config name, author and save first",level:"error"});return}try{e.disabled=!0,e.innerHTML='<div class="rpc-button-icon">☁️</div><span>Uploading...</span>';const m=V(),u=JSON.parse(JSON.stringify(m,(g,f)=>g==="clientId"?void 0:f)),c={title:a.value.trim(),author:s.value.trim(),configData:u};if(!((n=window.electronAPI)!=null&&n.uploadConfig))throw new Error("Cloud upload is not available");const r=await window.electronAPI.uploadConfig(c);U({message:`Config "${c.title}" uploaded!`,level:"success"}),a.value="",localStorage.setItem("configAuthor",c.author)}catch(m){U({message:`Upload failed: ${(m==null?void 0:m.message)??String(m)}`,level:"error"})}finally{e.disabled=!1,e.innerHTML='<div class="rpc-button-icon">☁️</div><span>Upload Current</span>'}}),o()}window.addEventListener("DOMContentLoaded",()=>{var e,l;ne(),le(),se(),re(),ue(),me(),fe(),de(),te(),pe(),ve(),ye(),W(null),T("CONNECTING RPC"),(e=window.electronAPI)!=null&&e.onRpcUpdate&&window.electronAPI.onRpcUpdate(o=>{W(o)}),(l=window.electronAPI)!=null&&l.onRpcStatus&&window.electronAPI.onRpcStatus(o=>{T(o)})});
